
# IEG CRM 사용자 및 설치 매뉴얼 (Ver. 2025.05)

본 문서는 **IEG CRM (Gemini AI 기반 영업 관리 시스템)**의 설치 및 사용 방법을 설명합니다. 
현재 버전은 Google Apps Script(GAS) 환경에서의 안정성을 위해 **모든 프론트엔드 코드가 하나의 파일로 통합**되어 있으며, 외부 아이콘 라이브러리 의존성을 제거하여 로딩 속도와 안정성을 획기적으로 개선했습니다.

---

## 1. 시스템 개요 및 변경 사항

IEG CRM은 영업 활동을 효율적으로 관리하기 위한 웹 애플리케이션입니다.

### 1.1 주요 변경 사항 (최신 버전 기준)
*   **통합 아키텍처**: 별도의 빌드 도구 없이 `index.html` 파일 하나에 모든 앱 로직(React, 스타일, 데이터)이 포함되어 설치가 매우 간편해졌습니다.
*   **안정성 강화**: 외부 아이콘 서버(CDN) 장애 시에도 화면이 깨지지 않도록 **내장 아이콘 시스템**을 적용했습니다.
*   **데이터 구조 세분화**:
    *   **팀 구성**: 영업1팀, 영업2팀, 영업팀, 마케팅본부, 해외사업팀
    *   **거래처 유형**: 고등학교, 대학교, 연구소, 융합원, 테크노파크, 협/단체
*   **대시보드 디자인**: 4컬럼 그리드 레이아웃 적용, 폰트 크기 확대, 인쇄(PDF) 최적화.

---

## 2. 설치 및 배포 가이드 (Google Apps Script)

이 시스템은 구글 스프레드시트와 연동되는 **Google Apps Script 웹 앱** 형태로 배포됩니다.

### 단계 1: 구글 스프레드시트 준비
1.  새 구글 스프레드시트를 생성하거나 기존 시트를 엽니다. (예시 ID: `1fWeLcQvotKZGgxelAOvKt_UXyYvdoneYVBeVXFMLRKY`)
2.  상단 메뉴의 **[확장 프로그램]** > **[Apps Script]**를 클릭하여 스크립트 에디터를 실행합니다.

### 단계 2: 백엔드 코드 설정 (Code.gs)
1.  스크립트 에디터에 기본으로 있는 `Code.gs` 파일을 엽니다.
2.  기존 내용을 모두 지우고, 제공된 **`backend/Code.js`** 의 내용을 복사하여 붙여넣습니다.
3.  코드 상단의 `SPREADSHEET_ID` 변수 값이 본인의 스프레드시트 ID와 일치하는지 확인합니다.
4.  **저장 (Ctrl+S)** 합니다.

### 단계 3: 프론트엔드 코드 설정 (index.html)
1.  좌측 파일 목록 옆의 **[+] (파일 추가)** 버튼을 클릭하고 **[HTML]**을 선택합니다.
2.  파일 이름을 **`index`**로 입력합니다. (확장자는 자동으로 `.html`이 됩니다.)
3.  생성된 `index.html`의 기존 내용을 모두 지웁니다.
4.  제공된 **대형 통합 코드 (`index.html` 전체 내용)**를 처음부터 끝까지 빠짐없이 복사하여 붙여넣습니다.
    *   *주의: 코드가 매우 길 수 있으므로 전체 복사가 되었는지 확인하세요.*
5.  **저장 (Ctrl+S)** 합니다.

### 단계 4: 권한 승인 (최초 1회)
1.  상단 툴바의 실행 함수 목록에서 **`getCRMData`**를 선택합니다.
2.  **[실행]** 버튼을 클릭합니다.
3.  "권한 검토" 팝업이 뜨면:
    *   **[권한 검토]** 클릭
    *   사용할 구글 계정 선택
    *   **[고급]** 클릭 -> **[... 프로젝트(으)로 이동 (안전하지 않음)]** 클릭
    *   **[허용]** 클릭
4.  실행 로그에 오류 없이 완료 메시지가 뜨면 성공입니다.

### 단계 5: 웹 앱 배포
1.  우측 상단의 **[배포]** > **[새 배포]**를 클릭합니다.
2.  설정 팝업에서:
    *   **유형 선택**: 톱니바퀴 아이콘 > **[웹 앱]** 선택
    *   **설명**: (예: Ver 1.0 배포)
    *   **다음 사용자로서 실행**: **'나 (웹 앱 소유자)'** (권장)
    *   **액세스 권한**: **'모든 사용자'** (가장 쉬운 접근) 또는 'Google 계정이 있는 모든 사용자'
3.  **[배포]** 버튼 클릭.
4.  제공되는 **웹 앱 URL**을 복사하여 브라우저 주소창에 붙여넣고 접속합니다.

---

## 3. 기능별 사용 매뉴얼

### A. 대시보드 (Dashboard)
영업 현황을 한눈에 파악하는 메인 화면입니다.
*   **범위 필터**: 상단의 [개인별 / 팀별 / 전체] 버튼을 통해 데이터를 필터링합니다. '개인별' 선택 시 우측 드롭다운에서 다른 직원의 실적도 조회 가능합니다.
*   **기간 필터**: [월별 / 분기별 / 누계] 버튼으로 집계 기준을 변경합니다.
*   **내보내기**: 우측 상단 [내보내기] 버튼 클릭 시:
    *   **Google Sheet**: 현재 데이터를 스프레드시트에 동기화합니다.
    *   **PDF 인쇄**: 현재 화면을 깔끔한 보고서 형태로 출력하거나 PDF로 저장합니다.
*   **차트**:
    *   월별 매출 현황: 1월~12월의 실적 추이를 누적 막대 그래프로 확인.
    *   등급 분포: 도넛 차트 내부에 등급과 비중(%), 외부에 금액(백만 단위) 표시.

### B. 거래처 및 매출 관리
거래처 정보와 관련 매출 건을 등록/수정합니다.
*   **등록**: [등록] 버튼을 눌러 회사명, 담당자, 유형(학교/연구소 등), 팀 정보를 입력합니다.
*   **주소 검색**: '주소 검색' 버튼을 누르면 모의 팝업이 뜨며, 주소를 선택하면 자동 입력됩니다.
*   **매출 정보**: 거래처 등록 시 '매출 정보 포함'을 체크하면 해당 건의 예상 매출액, 제품/상품 구분 금액, 상태(미정/확정 등)를 함께 입력할 수 있습니다.

### C. 거래처 상세 및 AI 도구
리스트에서 거래처를 클릭하면 상세 화면으로 이동합니다.
*   **AI 등급 분석**: [등급 분석 실행] 버튼을 누르면 Gemini AI가 Google 검색을 통해 해당 기관의 예산, 학생 수, 재무 상태 등을 조사하여 등급(S~D)을 제안합니다.
*   **AI 이메일 작성**: 'AI 이메일 초안' 탭에서 용건을 입력하면 정중한 비즈니스 이메일을 자동 작성해줍니다.
*   **회의록 요약**: 회의 메모를 입력하면 핵심 요약과 실행 항목(Action Item)을 추출합니다.

### D. 설정 (직원 관리)
*   **직원 등록**: 이름, 이메일, 팀, 직책을 입력하고 사진을 업로드하여 직원을 등록합니다.
*   **샘플 데이터 업로드**: [구글 시트에 샘플 업로드] 버튼을 누르면, 현재 화면에 보이는 테스트 데이터 100여 건을 즉시 구글 시트에 저장합니다. (시트가 비어있을 때 유용)
*   **초기화**: [샘플 데이터로 초기화] 버튼을 누르면 모든 데이터를 지우고 초기 상태로 되돌립니다.

---

## 4. 문제 해결 (Troubleshooting)

**Q. 화면이 하얗게 나오고 아무것도 안 뜹니다.**
*   A. `index.html` 파일에 코드를 붙여넣을 때 누락된 부분이 없는지 확인하세요. 제공된 코드는 매우 길기 때문에 전체 선택(Ctrl+A) 후 복사해야 합니다.

**Q. 차트가 보이지 않습니다.**
*   A. 브라우저를 새로고침 해보세요. 인터넷 연결이 원활해야 차트 라이브러리를 불러올 수 있습니다.

**Q. 구글 시트에 데이터가 저장되지 않습니다.**
*   A. 앱 좌측 하단의 **[저장/동기화]** 버튼을 누르거나, 설정 메뉴의 **[구글 시트에 샘플 업로드]** 버튼을 눌러야 실제 시트에 반영됩니다.

**Q. 배포 후 수정 사항이 반영되지 않습니다.**
*   A. Apps Script는 수정 후 반드시 **[새 배포]**를 해야 반영됩니다. 기존 URL을 그대로 쓰더라도 배포 버전 관리에서 '새로 만들기'를 선택해야 합니다.
